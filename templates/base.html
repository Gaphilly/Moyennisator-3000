<!DOCTYPE html>
<html lang="{{ get_locale() or 'fr' }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>{% block title %}Moyennisator 3000{% endblock %}</title>

    <!-- Bootstrap & icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            --bg-0: #1e3c72;
            --bg-1: #2a5298;
            --card-bg: rgba(255,255,255,0.10);
            --muted: rgba(255,255,255,0.75);
            --accent: #4dc9f6;
            --accent2: #f67019;
            --accent3: #f53794;
            --accent4: #acc236;
        }


        html {
            min-height: 100vh;
            width: 100vw;
        }
        body {
            min-height: 100vh;
            width: 100vw;
            background: linear-gradient(135deg, var(--bg-0) 0%, var(--bg-1) 100%) fixed;
            color: #f3f6fa;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }

        .navbar, .navbar-brand {
            background: transparent !important;
            color: #fff !important;
        }

        .container-main {
            max-width: 1100px;
            margin: 0 auto;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.10);
            color: inherit;
            box-shadow: 0 2px 12px 0 rgba(30,60,114,0.08);
        }

        .card-header {
            background: rgba(255,255,255,0.07);
            border-bottom: 1px solid rgba(255,255,255,0.10);
        }

        .btn-outline-light, .btn-outline-primary, .btn-outline-success, .btn-outline-danger, .btn-outline-warning {
            color: #fff;
            border-width: 2px;
            border-radius: 0.5rem;
            font-weight: 500;
            margin-right: 0.25rem;
        }
        .btn-outline-light { border-color: var(--accent); background: linear-gradient(90deg, var(--accent), var(--accent2)); }
        .btn-outline-primary { border-color: var(--accent2); background: linear-gradient(90deg, var(--accent2), var(--accent3)); }
        .btn-outline-success { border-color: var(--accent4); background: linear-gradient(90deg, var(--accent4), var(--accent)); }
        .btn-outline-danger { border-color: #e74c3c; background: linear-gradient(90deg, #e74c3c, #f53794); }
        .btn-outline-warning { border-color: #f1c40f; background: linear-gradient(90deg, #f1c40f, #f67019); color: #222; }

        .btn-outline-light:hover, .btn-outline-primary:hover, .btn-outline-success:hover, .btn-outline-danger:hover, .btn-outline-warning:hover {
            filter: brightness(1.1);
            opacity: 0.95;
        }

        .text-muted {
            color: var(--muted) !important;
        }

        /* small helpers used in results page */
        .subject-card { padding: 0.75rem; }
        .grade-badge {
            display: inline-block;
            padding: 0.15rem 0.45rem;
            border-radius: 0.35rem;
            margin-right: 0.25rem;
            font-size: 0.95rem;
            font-weight: 600;
            color: #fff;
        }
        /* Colorful grade badges for individual evaluations (improved greens, readable text) */
        .grade-badge.grade-v-plus {
            background: linear-gradient(90deg, #14532d 0%, #22c55e 100%); /* dark to vivid green */
            color: #fff;
            border: 1px solid #14532d;
        }
        .grade-badge.grade-v {
            background: linear-gradient(90deg, #bbf7d0 0%, #4ade80 100%); /* light to medium green */
            color: #222;
            border: 1px solid #4ade80;
        }
        .grade-badge.grade-j {
            background: linear-gradient(90deg, #f1c40f, #f67019);
            color: #222;
            border: 1px solid #f1c40f;
        }
        .grade-badge.grade-r {
            background: linear-gradient(90deg, #e74c3c, #f53794);
            color: #fff;
            border: 1px solid #e74c3c;
        }

        /* Ensure table text is always readable */
        table, th, td {
            color: #f3f6fa !important;
        }
    </style>

    {% block styles %}{% endblock %}
</head>
<body>

<nav class="navbar navbar-dark shadow-sm mb-4">
    <div class="container container-main">
        <a class="navbar-brand" href="{{ url_for('index') }}">Moyennisator 3000</a>
        <div class="d-flex align-items-center">
            {# use an explicit 'languages' mapping passed from the view when available #}
            {% if languages %}
                {% for code, name in languages.items() %}
                    <a class="btn btn-sm btn-outline-light ms-1" href="{{ url_for('set_language', language=code) }}">{{ name }}</a>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</nav>

<main class="container container-main py-3">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                {% set alert_class = 'danger' if category == 'error' else category %}
                <div class="alert alert-{{ alert_class }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</main>

<footer class="text-center text-muted py-3">
    &copy; {{ datetime.utcnow().year }} Moyennisator 3000
</footer>

<!-- Scripts: Bootstrap, Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

{% block scripts %}{% endblock %}
</body>
</html>